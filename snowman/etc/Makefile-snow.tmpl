#  -*- Makefile -*- Automatically generated for snow

# The main package
PKG=@PKG@
PKGVERS=@PKGVERS@

# Compiler 
SCC=stklos-compile
SFLAGS=

SO=@SO@
SCOMP=@SCOMP@
SLINK=@SLINK@

# Targets 
OSTK=@OSTK@

# General rules 
all: $(OSTK) $(PKGVERS).$(SO)

clean: 
	/bin/rm -f $(OSTK) $(PKGVERS).{c,stk,$(SO),o}

$(PKGVERS).ostk: src/$(PKG)/$(PKG).snow
	(cd src/$(PKG); $(SCC) $(SFLAGS) -o ../../$(PKG).ostk $(PKG).snow)

$(PKGVERS).$(SO): $(PKGVERS).c
	$(SCOMP) -c -DMODULE_ENTRY=1 -o $(PKGVERS).o $(PKGVERS).c
	$(SLINK) $(PKGVERS).so $(PKGVERS).o
	/bin/rm -f $(PKGVERS).o

$(PKGVERS).c: $(PKGVERS).stk
	$(SCC) -C -o $(PKGVERS).c $(PKGVERS).stk

# Rules for imported packages 
